<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Web de Base de datos CARBONORA</title>
        <meta name="description" content="Base de datos de empleados de la empresa minera de carbones CARBONORA.">
        <meta name="keywords" content="datos, empleados, mineria, HTML, SEO">
        <script src="auth-guard.js"></script>
        <link rel="stylesheet" href="carbonora.css">
        <link rel="stylesheet" href="empleados.css">
        <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
        <style>
            .notificaciones-container {
                max-width: 600px;
                margin: 40px auto 20px auto;
                background: #fff;
                border-radius: 18px;
                box-shadow: 0 8px 32px #0002;
                padding: 32px 24px;
            }
            .notificaciones-container h2 {
                text-align: center;
                color: #0D47A1;
                margin-bottom: 18px;
            }
            .notificaciones-list {
                list-style: none;
                padding: 0;
                margin: 0;
            }
            .notificacion-item {
                display: flex;
                align-items: center;
                background: #f7f7f7;
                border-radius: 10px;
                margin-bottom: 18px;
                padding: 18px 18px 18px 16px;
                box-shadow: 0 2px 12px #0001;
                opacity: 0;
                transform: translateY(30px);
                animation: fadeInUp 0.7s forwards;
                transition: background 0.2s;
                position: relative;
            }
            .notificacion-item .icon {
                font-size: 1.8em;
                margin-right: 16px;
                color: #0D47A1;
                flex-shrink: 0;
            }
            .notificacion-item .noti-content {
                flex: 1;
            }
            .notificacion-item .noti-time {
                font-size: 0.9em;
                color: #888;
                margin-left: 12px;
                white-space: nowrap;
            }
            .notificacion-item.added { border-left: 5px solid #4caf50; }
            .notificacion-item.deleted { border-left: 5px solid #e53935; }
            .notificacion-item.updated { border-left: 5px solid #ffb300; }
            @keyframes fadeInUp {
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
            body.dark .notificaciones-container { background: #232323; color: #f4f4f4; }
            body.dark .notificacion-item { background: #2d2d2d; }
        </style>
    </head>
<body>
    <div class="notificaciones-container">
        <h2>Notificaciones</h2>
        <ul class="notificaciones-list" id="notificacionesList">
            <!-- Notificaciones animadas aquí -->
        </ul>
        <div id="no-noti-msg" style="text-align:center;color:#888;margin-top:30px;">No hay notificaciones recientes.</div>
    </div>
    <footer>
        <p><em>Ayuda</em></p>
        <p><em>Contáctenos</em></p>
    </footer>
   
<!-------------------------------------CREACION INICIO SIDE BAR---------------------------------------------------------->
<nav class="sidebar close">
    <header>
      <div class="image-text">
        <span class="image">
          <img src="Imagenes/logo-arizona.jpg" alt="LOGO">
        </span>
        <div class="text header-text">
          <span class="name">Carbonora</span>
          <span class="profesion">RH</span>
        </div>
      </div>
      <i class='bx bx-chevron-right toggle'></i>
    </header>
    <div class="menu-bar">
      <div class="menu">
        <li class="search-box">
          <i class='bx bx-search icon'></i>
          <input type="text" placeholder="Buscar...">
        </li>
        <ul class="menu-links">
          <li class="nav-link">
            <a href="Inicio.html">
              <i class='bx bx-home-alt icon'></i>
              <span class="text nav-text">Inicio</span>
            </a>
          </li>
          <!-- ITEM EMPLEADOS -->
          <li class="nav-link has-submenu">
            <a href="Empleados.html">
              <i class='bx bxs-user-detail icon'></i>
              <span class="text nav-text">Empleados</span>
            </a>
            <ul class="SubEmpleados">
              <li><a href="Gerente.html">Gerente</a></li>
              <li><a href="Departamentos.html">Departamentos</a></li>
              <li><a href="Areas.html">Áreas</a></li>
            </ul>
          </li>
          <li class="nav-link">
            <a href="notificaciones.html">
              <i class='bx bx-bell icon'></i>
              <span class="text nav-text">Notificaciones</span>
            </a>
          </li>
          <li class="nav-link">
            <a href="estadisticas.html">
              <i class='bx bx-pie-chart-alt icon'></i>
              <span class="text nav-text">Estadisticas</span>
            </a>
          </li>
          <li class="nav-link">
            <a href="PQRS.html">
              <i class='bx bx-comment-error icon'></i>
              <span class="text nav-text">PQRS</span>
            </a>
          </li>
          <li class="nav-link">
            <a href="soporte.html">
              <i class='bx bx-help-circle icon'></i>
              <span class="text nav-text">Soporte</span>
            </a>
          </li>
        </ul>
      </div>
      <div class="bottom-content">
        <li>
          <a href="index.html">
            <i class='bx bx-log-out icon'></i>
            <span class="text nav-text">Salir</span>
          </a>
        </li>
        <li class="mode">
          <div class="sun-moon">
            <i class='bx bx-moon icon moon'></i>
            <i class='bx bx-sun icon sun'></i>
          </div>
          <span class="mode-text text">Modo oscuro</span>
          <div class="toggle-switch">
            <span class="switch"></span>
          </div>
        </li>
      </div>
    </div>
  </nav>
  <button id="scrollTopBtn" title="Volver arriba">⬆</button>
    <script>
    // ======= Referencias =======
    const sidebar   = document.querySelector('.sidebar');
    const toggleBtn = document.querySelector('.toggle');

    // Ítem Empleados y su submenú
    const empleadosItem = document.querySelector('.nav-link a[href="Empleados.html"]').parentElement;
    const submenu = empleadosItem.querySelector('.SubEmpleados');

    // ======= Sidebar: Hover general =======
    sidebar.addEventListener('mouseenter', () => {
      if (!sidebar.classList.contains('pinned')) {
        sidebar.classList.remove('close');
      }
    });
    sidebar.addEventListener('mouseleave', () => {
      if (!sidebar.classList.contains('pinned')) {
        sidebar.classList.add('close');
      }
    });

    // ======= Botón Toggle (fijar/desfijar) =======
    toggleBtn.addEventListener('click', () => {
      if (sidebar.classList.contains('pinned')) {
        sidebar.classList.remove('pinned');
        sidebar.classList.add('close');
      } else {
        sidebar.classList.remove('close');
        sidebar.classList.add('pinned');
      }
    });

    // ======= Hover en "Empleados" para expandir la barra y mostrar submenú =======
    empleadosItem.addEventListener('mouseenter', () => {
      // Expandir la sidebar si está colapsada
      if (sidebar.classList.contains('close')) {
        sidebar.classList.remove('close');
      }
      // Mostrar el submenú
      submenu.style.display = 'block';
    });

    // ======= Lógica para mantener submenú abierto mientras el mouse está sobre él =======
    let isOverSubmenu = false;

    submenu.addEventListener('mouseenter', () => {
      isOverSubmenu = true;
    });
    submenu.addEventListener('mouseleave', () => {
      isOverSubmenu = false;
      submenu.style.display = 'none';
      if (!sidebar.classList.contains('pinned')) {
        sidebar.classList.add('close');
      }
    });

    // Al salir del ítem "Empleados", damos un pequeño retardo por si se mueve al submenú
    empleadosItem.addEventListener('mouseleave', () => {
      setTimeout(() => {
        if (!isOverSubmenu) {
          submenu.style.display = 'none';
          if (!sidebar.classList.contains('pinned')) {
            sidebar.classList.add('close');
          }
        }
      }, 150);
    });
     //Boton //
     const btn = document.getElementById("scrollTopBtn");

window.addEventListener('scroll', () => {
  btn.style.display = window.scrollY > 300 ? 'block' : 'none';
});

btn.addEventListener('click', () => {
  window.scrollTo({ top: 0, behavior: 'smooth' });
});

    // Animación y lógica de notificaciones
    // Simulación: las notificaciones se guardan en localStorage por simplicidad
    // En producción, deberías obtenerlas de un backend o WebSocket

    function getNotificaciones() {
        // Devuelve un array de notificaciones recientes (máx 20)
        let notis = [];
        try {
            notis = JSON.parse(localStorage.getItem('notificaciones_carbonora') || '[]');
        } catch { notis = []; }
        return notis.slice(-20).reverse();
    }

    function renderNotificaciones() {
        const list = document.getElementById('notificacionesList');
        const noMsg = document.getElementById('no-noti-msg');
        const notis = getNotificaciones();
        list.innerHTML = '';
        if (notis.length === 0) {
            noMsg.style.display = 'block';
            return;
        }
        noMsg.style.display = 'none';
        notis.forEach((noti, idx) => {
            const li = document.createElement('li');
            li.className = `notificacion-item ${noti.tipo}`;
            li.style.animationDelay = (idx * 0.08) + 's';
            let icon = '<i class="bx bx-info-circle icon"></i>';
            if (noti.tipo === 'added') icon = '<i class="bx bx-user-plus icon"></i>';
            if (noti.tipo === 'deleted') icon = '<i class="bx bx-user-x icon"></i>';
            if (noti.tipo === 'updated') icon = '<i class="bx bx-edit icon"></i>';
            li.innerHTML = `
                ${icon}
                <div class="noti-content">${noti.mensaje}</div>
                <div class="noti-time">${noti.fecha}</div>
            `;
            list.appendChild(li);
        });
    }

    // Para pruebas: escucha eventos de empleados en otras páginas y guarda notificaciones en localStorage
    window.addEventListener('storage', function(e) {
        if (e.key === 'notificaciones_carbonora') renderNotificaciones();
    });

    // Inicializar
    document.addEventListener('DOMContentLoaded', renderNotificaciones);

    // ======= Modo oscuro =======
    document.addEventListener('DOMContentLoaded', () => {
      const body = document.querySelector('body');
      const modeSwitch = document.querySelector('.toggle-switch');
      const modeText = document.querySelector('.mode-text');
      if (!modeSwitch || !modeText || !body) return;

      // Cargar modo desde localStorage
      if (localStorage.getItem('theme') === 'dark') {
        body.classList.add('dark');
        modeText.innerText = 'Modo claro';
      }

      // Cambiar entre modo oscuro y claro
      modeSwitch.addEventListener('click', () => {
        body.classList.toggle('dark');
        const isDark = body.classList.contains('dark');
        localStorage.setItem('theme', isDark ? 'dark' : 'light');
        modeText.innerText = isDark ? 'Modo claro' : 'Modo oscuro';
      });
    });
    </script>
</body>
</html>